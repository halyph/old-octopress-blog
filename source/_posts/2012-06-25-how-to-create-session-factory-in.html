---
layout: post
title: How to Create Session Factory in Hibernate 4
date: '2012-06-25T21:06:00.001+03:00'
author: Orest Ivasiv
categories:
- java
- hibernate
modified_time: '2012-06-25T21:07:54.153+03:00'
blogger_id: tag:blogger.com,1999:blog-7372777165432727866.post-4346317016219278375
blogger_orig_url: http://www.halyph.com/2012/06/how-to-create-session-factory-in.html
---

You've probably noticed that <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">org.hibernate.cfg.Configuration.buildSessionFactory</span> is deprecated in Hibernate4, check out Javadocs:<br /><br /><pre class="brush: java;">/**<br /> * Create a {@link SessionFactory} using the properties and mappings in this configuration. The<br /> * {@link SessionFactory} will be immutable, so changes made to {@code this} {@link Configuration} after<br /> * building the {@link SessionFactory} will not affect it.<br /> *<br /> * @return The build {@link SessionFactory}<br /> *<br /> * @throws HibernateException usually indicates an invalid configuration or invalid mapping information<br /> *<br /> * @deprecated Use {@link #buildSessionFactory(ServiceRegistry)} instead<br /> */<br />public SessionFactory buildSessionFactory() throws HibernateException <br /></pre><br />E.g. We have the next old-fashion Hibernate3 code snippets:<br /><pre class="brush: java;">SessionFactory sessionFactory = new Configuration().configure().buildSessionFactory();<br /><br />Session session = sessionFactory.openSession();<br />session.beginTransaction();<br />session.save(new Event("Our very first event!", new Date()));<br />session.save(new Event("A follow up event", new Date()));<br />session.getTransaction().commit();<br />session.close();<br /></pre><br />Based on Javadocs above we have to apply the next small changes to support new Hibernate 4 <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">buildSessionFactory(ServiceRegistry)</span>: <br /><pre class="brush: java;">Configuration configuration = new Configuration();<br />configuration.configure();<br />ServiceRegistry serviceRegistry = new ServiceRegistryBuilder().applySettings(configuration.getProperties()).buildServiceRegistry();<br />SessionFactory sessionFactory = configuration.buildSessionFactory(serviceRegistry);<br /><br />Session session = sessionFactory.openSession();<br />session.beginTransaction();<br />session.save(new Event("Our very first event!", new Date()));<br />session.save(new Event("A follow up event", new Date()));<br />session.getTransaction().commit();<br />session.close();<br /></pre>You can clone code sample from <a href="https://github.com/halyph/hibernate4-session-factory-sample">https://github.com/halyph/hibernate4-session-factory-sample</a>